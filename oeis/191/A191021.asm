; A191021: Primes that are squares mod 23.
; Submitted by Ralfy
; 2,3,13,29,31,41,47,59,71,73,101,127,131,139,151,163,167,173,179,193,197,211,223,233,239,257,269,271,277,307,311,317,331,347,349,353,397,409,439,443,449,461,463,487,491,499,509,541,547,577,587,593,599,601,607,647,653,673,683,691,719,739,761,809,811,821,823,829,853,857,859,863,877,883,887,929,947,967,991,997,1013,1021,1039,1051,1061,1087,1093,1097,1117,1129,1151,1153,1163,1181,1223,1231,1237,1277,1283,1289

mov $2,$0
add $2,2
pow $2,2
lpb $2
  mov $3,$1
  seq $3,278580 ; Numbers n such that Jacobi(n,23) = 1.
  sub $3,1
  mov $5,$3
  seq $3,10051 ; Characteristic function of primes: 1 if n is prime, else 0.
  sub $0,$3
  add $1,1
  mov $4,$0
  max $4,0
  cmp $4,$0
  mul $2,$4
  trn $2,1
lpe
mov $0,$5
add $0,1
