; A104589: a(1)=1. a(n) = a(n-1) + (sum of terms, from among terms a(1) through a(n-1), which are prime or 1).
; Submitted by Simon Strandgaard (raspberrypi)
; 1,2,5,13,34,55,76,97,215,333,451,569,1256,1943,2630,3317,4004,4691,10069,25516,40963,56410,71857,87304,102751,118198,133645,149092,164539,179986,195433,210880,226327,241774,257221,529889,802557,1075225,1347893,2968454,4589015,6209576,7830137,9450698,11071259,12691820,14312381,30245323,46178265,62111207,78044149,93977091,109910033,235753008,361595983,487438958,613281933,739124908,864967883,990810858,1116653833,1242496808,1368339783,1494182758,1620025733,3365894441,5111763149,6857631857
; Formula: a(n) = b(n)+1, b(n) = A010051(b(n-1))*(b(n-1)+1)+b(n-1)+c(n-1), b(1) = 1, b(0) = 0, c(n) = A010051(b(n-1))*(b(n-1)+1)+c(n-1), c(1) = 1, c(0) = 1

mov $2,1
lpb $0
  sub $0,1
  mov $3,$2
  mov $4,$1
  seq $4,10051 ; Characteristic function of primes: 1 if n is prime, else 0.
  mov $2,$1
  add $2,1
  mul $2,$4
  add $2,$3
  add $1,$2
lpe
mov $0,$1
add $0,1
