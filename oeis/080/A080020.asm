; A080020: Primes of the form 9k^2 + 3k + 367, where k can be negative.
; Submitted by Cruncher Pete
; 367,373,379,397,409,439,457,499,523,577,607,673,709,787,829,919,967,1069,1123,1237,1297,1423,1489,1627,1699,2089,2347,2437,2719,2917,3019,3229,3559,3673,3907,4027,4273,4657,4789,5059,5197,5479,5623,6067,6373,6529,7507,8377,8923,9109,9679,10069,10267,11287,11497,11923,12577,12799,13249,13477,14173,14887,15373,15619,16369,16879,17137,17659,17923,18457,19273,20107,20389,20959,21247,22123,22717,23017,23623,23929,24547,24859,26449,27427,28759,29437,30469,30817,31873,32587,34039,35149,35899,36277

add $0,1
mov $2,366
mov $3,$0
pow $3,5
lpb $3
  mov $1,$2
  seq $1,10051 ; Characteristic function of primes: 1 if n is prime, else 0.
  add $4,2
  sub $0,$1
  add $2,$4
  sub $3,$0
lpe
mov $0,$2
add $0,1
